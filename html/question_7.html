<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Билет №7 - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.markdown-body kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,sans-serif;padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;padding:0 15px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}.ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}.markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}.ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}.markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}.ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:contain}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" style="position: relative;"><h1 id="Билет-№7"><a class="anchor hidden-xs" href="#Билет-№7" title="Билет-№7"><span class="octicon octicon-link"></span></a>Билет №7</h1><h2 id="Вопрос-1-Word-embeddings-Co-occurrence-Matrix-Word2Vec-CBOW-Skip-Gram-GloVE-FastText"><a class="anchor hidden-xs" href="#Вопрос-1-Word-embeddings-Co-occurrence-Matrix-Word2Vec-CBOW-Skip-Gram-GloVE-FastText" title="Вопрос-1-Word-embeddings-Co-occurrence-Matrix-Word2Vec-CBOW-Skip-Gram-GloVE-FastText"><span class="octicon octicon-link"></span></a>Вопрос 1: Word embeddings: Co-occurrence Matrix, Word2Vec, CBOW, Skip-Gram, GloVE, FastText.</h2><h3 id="Word-embedding"><a class="anchor hidden-xs" href="#Word-embedding" title="Word-embedding"><span class="octicon octicon-link"></span></a>Word embedding</h3><p><a href="https://ru.wikipedia.org/wiki/%D0%92%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%B5%D0%B4%D1%81%D1%82%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%81%D0%BB%D0%BE%D0%B2" target="_blank" rel="noopener">Источник того, что ниже - википедия.</a><br>
<strong>Векторное представление</strong> — общее название для различных подходов к моделированию языка и обучению представлений в обработке естественного языка, направленных на сопоставление словам (и, возможно, фразам) из некоторого словаря векторов из <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>R</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msup></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-810" style="width: 1.591em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1001.28em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-811"><span class="msubsup" id="MathJax-Span-812"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.77em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-813" style="font-family: MathJax_Math; font-style: italic;">R</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.771em;"><span class="texatom" id="MathJax-Span-814"><span class="mrow" id="MathJax-Span-815"><span class="mi" id="MathJax-Span-816" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>R</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-53">R^{n}</script></span> для <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-817" style="width: 0.771em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.62em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-818"><span class="mi" id="MathJax-Span-819" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">n</script></span>, значительно меньшего количества слов в словаре. Теоретической базой для векторных представлений является дистрибутивная семантика.</p><blockquote>
<p><strong>Дистрибутивна семантика</strong> — это область лингвистики, которая занимается вычислением степени есмантической близости между лингвистическими единицами на основании их распределения (дистрибуции) в больших массивах лингвистических данных.</p>
<p>Каждому слову присваивается свой контекстный вектор. Множество векторов формирует словесное векторное пространство.</p>
<p>Семантическое расстояние между понятиями, выраженными словами естественного языка, обычно вычисляется как косинусное расстояние между векторами словесного пространства.</p>
</blockquote><p><a href="https://lilianweng.github.io/lil-log/2017/10/15/learning-word-embedding.html" target="_blank" rel="noopener">Источник того, что ниже.</a><br>
There are two main approaches for learning word embedding, both relying on the contextual knowledge.</p><ul>
<li><strong>Count-based</strong>: The first one is unsupervised, based on matrix factorization of a global word co-occurrence matrix. Raw co-occurrence counts do not work well, so we want to do smart things on top.
<ul>
<li>Co-occurence matrix</li>
<li>glove</li>
</ul>
</li>
<li><strong>Context-based</strong>: The second approach is supervised. Given a local context, we want to design a model to predict the target words and in the meantime, this model learns the efficient word embedding representation.
<ul>
<li>word2vec</li>
<li>cbow</li>
<li>skip-gram</li>
<li>glove</li>
<li>fasttext</li>
</ul>
</li>
</ul><h3 id="Co-occurence-matrix"><a class="anchor hidden-xs" href="#Co-occurence-matrix" title="Co-occurence-matrix"><span class="octicon octicon-link"></span></a>Co-occurence matrix</h3><p><a href="https://medium.com/data-science-group-iitr/word-embedding-2d05d270b285" target="_blank" rel="noopener">Источник того, что ниже.</a><br>
Words co-occurrence matrix describes how words occur together that in turn captures the relationships between words. Words co-occurrence matrix is computed simply by counting how two or more words occur together in a given corpus. As an example of words co-occurrence, consider a corpus consisting of the following documents:<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mi>e</mi><mi>n</mi><mi>n</mi><mi>y</mi><mtext>&amp;#xA0;</mtext><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi><mtext>&amp;#xA0;</mtext><mi>a</mi><mi>n</mi><mi>d</mi><mtext>&amp;#xA0;</mtext><mi>p</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>d</mi><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>o</mi><mi>o</mi><mi>l</mi><mi>i</mi><mi>s</mi><mi>h</mi><mo>.</mo><mspace linebreak=&quot;newline&quot; /><mi>a</mi><mtext>&amp;#xA0;</mtext><mi>p</mi><mi>e</mi><mi>n</mi><mi>n</mi><mi>y</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>d</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>s</mi><mtext>&amp;#xA0;</mtext><mi>a</mi><mtext>&amp;#xA0;</mtext><mi>p</mi><mi>e</mi><mi>n</mi><mi>n</mi><mi>y</mi><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>e</mi><mi>d</mi><mo>.</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2937" style="width: 100%; display: inline-block; min-width: 17.728em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(3.128em, 1014.4em, 5.689em, -999.997em); top: -3.993em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-2938"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1013.42em, 4.357em, -999.997em); top: -3.993em; left: 50%; margin-left: -6.76em;"><span class="mi" id="MathJax-Span-2939" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-2940" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2941" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2942" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2943" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-2944" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2945" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mi" id="MathJax-Span-2946" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-2947" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-2948" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mtext" id="MathJax-Span-2949" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2950" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2951" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2952" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-2953" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2954" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-2955" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-2956" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-2957" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2958" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-2959" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2960" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-2961" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-2962" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-2963" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-2964" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-2965" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-2966" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mo" id="MathJax-Span-2967" style="font-family: MathJax_Main;">.</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1014.4em, 4.357em, -999.997em); top: -2.661em; left: 50%; margin-left: -7.221em;"><span class="mspace" id="MathJax-Span-2968" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-2969" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mtext" id="MathJax-Span-2970" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2971" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-2972" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2973" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2974" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2975" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-2976" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2977" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-2978" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2979" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mi" id="MathJax-Span-2980" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2981" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-2982" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2983" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-2984" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mtext" id="MathJax-Span-2985" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2986" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mtext" id="MathJax-Span-2987" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2988" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-2989" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2990" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2991" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2992" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-2993" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-2994" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2995" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-2996" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-2997" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-2998" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-2999" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-3000" style="font-family: MathJax_Main;">.</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.934em; border-left: 0px solid; width: 0px; height: 2.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mi>e</mi><mi>n</mi><mi>n</mi><mi>y</mi><mtext>&nbsp;</mtext><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi><mtext>&nbsp;</mtext><mi>a</mi><mi>n</mi><mi>d</mi><mtext>&nbsp;</mtext><mi>p</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>d</mi><mtext>&nbsp;</mtext><mi>f</mi><mi>o</mi><mi>o</mi><mi>l</mi><mi>i</mi><mi>s</mi><mi>h</mi><mo>.</mo><mspace linebreak="newline"></mspace><mi>a</mi><mtext>&nbsp;</mtext><mi>p</mi><mi>e</mi><mi>n</mi><mi>n</mi><mi>y</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>d</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>s</mi><mtext>&nbsp;</mtext><mi>a</mi><mtext>&nbsp;</mtext><mi>p</mi><mi>e</mi><mi>n</mi><mi>n</mi><mi>y</mi><mtext>&nbsp;</mtext><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>e</mi><mi>d</mi><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-112">penny\ wise\ and\ pound\ foolish. \\
a\ penny\ saved\ is\ a\ penny\ earned.</script></span><br>
Letting <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>w</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>w</mi><mo stretchy=&quot;false&quot;>(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3001" style="width: 14.449em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.837em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1011.73em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3002"><span class="mi" id="MathJax-Span-3003" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-3004" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-3005" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-3006" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3007" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-3008" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3009" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-3010" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3011" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3012" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3013" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-3014" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-3015" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-3016"><span class="mrow" id="MathJax-Span-3017"><span class="mo" id="MathJax-Span-3018" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-3019" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-3020" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3021" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-3022" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-3023" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-3024" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-3025" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3026" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3027" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-3028" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-3029" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">(</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-113">count(w(next)|w(current))</script></span> represent how many times word <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3030" style="width: 4.255em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.486em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.38em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3031"><span class="mi" id="MathJax-Span-3032" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-3033" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3034" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3035" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3036" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-3037" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-3038" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo stretchy="false">(</mo><mi>n</mi><mi>e</mi><mi>x</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-114">w(next)</script></span> follows the word <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi><mo stretchy=&quot;false&quot;>(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3039" style="width: 5.894em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.818em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1004.72em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3040"><span class="mi" id="MathJax-Span-3041" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mo" id="MathJax-Span-3042" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-3043" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-3044" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-3045" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-3046" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-3047" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-3048" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-3049" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-3050" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo stretchy="false">(</mo><mi>c</mi><mi>u</mi><mi>r</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-115">w(current)</script></span>, we can summarize co-occurrence statistics for words “a” and “penny” as:</p><p>
  <img src="https://github.com/natalymr/dl-notes/blob/master/pictures/question_7/co_oc_matrix_table.png?raw=true">
</p><p>Now, a column can also be understood as word vector for the corresponding word in the matrix <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2464" style="width: 1.335em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1001.08em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2465"><span class="mi" id="MathJax-Span-2466" style="font-family: MathJax_Math; font-style: italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-98">M</script></span>. For example, the word vector for ‘cat’ in the above matrix is <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2467" style="width: 2.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.001em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.9em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2468"><span class="mo" id="MathJax-Span-2469" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-2470" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-2471" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-2472" style="font-family: MathJax_Main; padding-left: 0.156em;">1</span><span class="mo" id="MathJax-Span-2473" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-99">[1,1]</script></span> and so on.Here, the rows correspond to the documents in the corpus and the columns correspond to the tokens in the dictionary. The second row in the above matrix may be read as — Document <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2474" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2475"><span class="mn" id="MathJax-Span-2476" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-100">2</script></span> contains ‘hat’: once, ‘dog’: once and ‘the’ thrice and so on.</p><p>Дальше, получив матрицу совместной встречаемости, можно уменьшить ее размер, применив <a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%82%D0%BE%D0%B4_%D0%B3%D0%BB%D0%B0%D0%B2%D0%BD%D1%8B%D1%85_%D0%BA%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%B5%D0%BD%D1%82" target="_blank" rel="noopener">PCA.</a></p><blockquote>
<p><strong>Вычисление главных компонент, PCA</strong>, один из основных способов уменьшить размерность данных, потеряв наименьшее количество информации. Этот способ может быть сведен к вычислению сингулярного разложения матрицы данных или к вычислению собственных векторов и собственных значений ковариационной матрицы исходных данных.</p>
</blockquote><h3 id="word2vec"><a class="anchor hidden-xs" href="#word2vec" title="word2vec"><span class="octicon octicon-link"></span></a>word2vec</h3><p><a href="" target="_blank" rel="noopener">Источник того, что ниже - лекции.</a><br>
Предположим, что у нас есть языковая модель, то есть набор вероятностей: пусть у нас есть набор слов, мы по нему проходимся, и в какой-то момент стоим на слове  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mi>i</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3625" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1001.03em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3626"><span class="msubsup" id="MathJax-Span-3627"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3628" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-3629" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-176">w_i</script></span>, мы хотим предсказать по словам  <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mi>k</mi></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>w</mi><mi>i</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3630" style="width: 6.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.126em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1005.13em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3631"><span class="msubsup" id="MathJax-Span-3632"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3633" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-3634"><span class="mrow" id="MathJax-Span-3635"><span class="mi" id="MathJax-Span-3636" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-3637" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-3638" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-3639" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-3640" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-3641" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-3642" style="font-family: MathJax_Main; padding-left: 0.156em;">.</span><span class="mo" id="MathJax-Span-3643" style="font-family: MathJax_Main; padding-left: 0.156em;">,</span><span class="msubsup" id="MathJax-Span-3644" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3645" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-3646" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mi>k</mi></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>w</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-177">w_{i - k}, ..., w_i</script></span>, какое слово будет стоять следующим и для каждого слова из словаря считаем его вероятность быть <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-3647" style="width: 2.41em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1001.95em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-3648"><span class="msubsup" id="MathJax-Span-3649"><span style="display: inline-block; position: relative; width: 1.949em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-3650" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-3651"><span class="mrow" id="MathJax-Span-3652"><span class="mi" id="MathJax-Span-3653" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-3654" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-3655" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-178">w_{i + 1}</script></span>.<br>
Основное отличие заключается в том, что <em>теперь рассматриваем отношение не одного слова к другому, а <strong>группы слов к одному</strong></em>.</p><p>Наша задача найти такую функцию <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-259-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7381" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.57em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-7382"><span class="mi" id="MathJax-Span-7383" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-259">f</script></span>, которая</p><ol>
<li>от слов, которые часто встречаются вместе, давала бы что-то большое,</li>
<li>от слов, которые встречаются рядом редко, давала бы что-то маленькое.</li>
</ol><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-256-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>w</mi><mi>i</mi></msub><mo>&amp;#x2208;</mo><mi>D</mi><mi>i</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>a</mi><mi>r</mi><mi>y</mi></mrow></munder><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mi>i</mi></msub><mo>,</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7267" style="width: 30.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.593em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.566em, 1024.59em, 3.486em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-7268"><span class="mi" id="MathJax-Span-7269" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mo" id="MathJax-Span-7270" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-7271"><span style="display: inline-block; position: relative; width: 3.845em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-7272" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-7273"><span class="mrow" id="MathJax-Span-7274"><span class="mi" id="MathJax-Span-7275" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-7276" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-7277" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-7278" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7279" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-7280" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7281" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-7282" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-7283" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-7284"><span class="mrow" id="MathJax-Span-7285"><span class="mo" id="MathJax-Span-7286" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-7287"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-7288" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-7289"><span class="mrow" id="MathJax-Span-7290"><span class="mi" id="MathJax-Span-7291" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-7292" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-7293" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-7294" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-7295" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-7296" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-7297" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-7298" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-7299" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mfrac" id="MathJax-Span-7300" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 14.296em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.076em, 1010.91em, 4.408em, -999.997em); top: -4.711em; left: 50%; margin-left: -5.53em;"><span class="mrow" id="MathJax-Span-7301"><span class="mi" id="MathJax-Span-7302" style="font-family: MathJax_Main;">exp</span><span class="mo" id="MathJax-Span-7303"></span><span class="mo" id="MathJax-Span-7304" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7305" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-7306" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-7307"><span style="display: inline-block; position: relative; width: 3.845em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-7308" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-7309"><span class="mrow" id="MathJax-Span-7310"><span class="mi" id="MathJax-Span-7311" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-7312" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-7313" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-7314" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7315" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-7316" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-7317" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-7318" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-7319" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-7320" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-7321" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-7322" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-7323"><span class="mrow" id="MathJax-Span-7324"><span class="mi" id="MathJax-Span-7325" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-7326" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-7327" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-7328" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-7329" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-7330" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-7331" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-7332" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-7333" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1014.04em, 4.562em, -999.997em); top: -3.276em; left: 50%; margin-left: -7.067em;"><span class="mrow" id="MathJax-Span-7334"><span class="munderover" id="MathJax-Span-7335"><span style="display: inline-block; position: relative; width: 5.791em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.03em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-7336" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.686em; left: 1.078em;"><span class="texatom" id="MathJax-Span-7337"><span class="mrow" id="MathJax-Span-7338"><span class="msubsup" id="MathJax-Span-7339"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-7340" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.515em;"><span class="mi" id="MathJax-Span-7341" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-7342" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-7343" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">D</span><span class="mi" id="MathJax-Span-7344" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-7345" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-7346" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-7347" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-7348" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-7349" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-7350" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-7351" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-7352" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-7353" style="font-family: MathJax_Main; padding-left: 0.156em;">exp</span><span class="mo" id="MathJax-Span-7354"></span><span class="mo" id="MathJax-Span-7355" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-7356" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-7357" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-7358"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-7359" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-7360" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-7361" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-7362" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-7363" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-7364"><span class="mrow" id="MathJax-Span-7365"><span class="mi" id="MathJax-Span-7366" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-7367" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-7368" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-7369" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-7370" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-7371" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-7372" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-7373" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-7374" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1014.3em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 14.296em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.434em; border-left: 0px solid; width: 0px; height: 3.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>w</mi><mi>i</mi></msub><mo>∈</mo><mi>D</mi><mi>i</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>a</mi><mi>r</mi><mi>y</mi></mrow></munder><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo>,</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-256">P(w_{candidate} | w_{context}) = \frac{\exp(f(w_{candidate}, w_{context}))}{\sum_{w_i \in Dictionary} \exp(f(w_i, w_{context}))}</script></span></p><p>Самый простой, неплохо работающий вариант<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-341-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=&amp;lt;</mo><msub><mi>u</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow></msub></mrow></msub><mo>,</mo><msub><mi>v</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub></mrow></msub><mo>&amp;gt;</mo><mo>,</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9977" style="width: 22.851em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.701em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1018.65em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-9978"><span class="mi" id="MathJax-Span-9979" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-9980" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-9981"><span style="display: inline-block; position: relative; width: 3.845em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-9982" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-9983"><span class="mrow" id="MathJax-Span-9984"><span class="mi" id="MathJax-Span-9985" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-9986" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-9987" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-9988" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-9989" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-9990" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-9991" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-9992" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-9993" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-9994" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-9995" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 3.128em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-9996" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-9997"><span class="mrow" id="MathJax-Span-9998"><span class="mi" id="MathJax-Span-9999" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-10000" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-10001" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-10002" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-10003" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-10004" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-10005" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-10006" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-10007" style="font-family: MathJax_Main; padding-left: 0.259em;">=<span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">&lt;</span></span><span class="msubsup" id="MathJax-Span-10008" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-10009" style="font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="texatom" id="MathJax-Span-10010"><span class="mrow" id="MathJax-Span-10011"><span class="msubsup" id="MathJax-Span-10012"><span style="display: inline-block; position: relative; width: 2.718em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-10013" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.515em;"><span class="texatom" id="MathJax-Span-10014"><span class="mrow" id="MathJax-Span-10015"><span class="mi" id="MathJax-Span-10016" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-10017" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-10018" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-10019" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-10020" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-10021" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-10022" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-10023" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-10024" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">e</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-10025" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-10026" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 2.769em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-10027" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="texatom" id="MathJax-Span-10028"><span class="mrow" id="MathJax-Span-10029"><span class="msubsup" id="MathJax-Span-10030"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-10031" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.515em;"><span class="texatom" id="MathJax-Span-10032"><span class="mrow" id="MathJax-Span-10033"><span class="mi" id="MathJax-Span-10034" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-10035" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-10036" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-10037" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-10038" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-10039" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-10040" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-10041" style="font-family: MathJax_Main; padding-left: 0.259em;">&gt;</span><span class="mo" id="MathJax-Span-10042" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo>=&lt;</mo><msub><mi>u</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow></msub></mrow></msub><mo>,</mo><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>x</mi><mi>t</mi></mrow></msub></mrow></msub><mo>&gt;</mo><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-341">f(w_{candidate}, w_{context}) = <u_{w_{candidate}}, v_{w_{context}}>,</script></span><br>
то есть <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-342-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10043" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.57em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-10044"><span class="mi" id="MathJax-Span-10045" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-342">f</script></span> - скалярное произведение векторов.</p><p>В итоге, хотим максимизировать следующую функцию (логарифм от softmax):<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1634-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>m</mi><mo>&amp;#x2264;</mo><mi>j</mi><mo>&amp;#x2264;</mo><mi>m</mi><mo>,</mo><mtext>&amp;#xA0;</mtext><mi>j</mi><mo>&amp;#x2260;</mo><mn>0</mn></mrow></munder><mi>log</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>j</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>w</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30613" style="width: 22.595em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.496em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.31em, 1018.45em, 3.742em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-30614"><span class="mi" id="MathJax-Span-30615" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mo" id="MathJax-Span-30616" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-30617" style="font-family: MathJax_Math; font-style: italic;">θ</span><span class="mo" id="MathJax-Span-30618" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-30619" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mo" id="MathJax-Span-30620" style="font-family: MathJax_Main; padding-left: 0.259em;">−</span><span class="mfrac" id="MathJax-Span-30621"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.179em, 1000.41em, 4.152em, -999.997em); top: -4.659em; left: 50%; margin-left: -0.254em;"><span class="mn" id="MathJax-Span-30622" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.179em, 1000.72em, 4.152em, -999.997em); top: -3.327em; left: 50%; margin-left: -0.356em;"><span class="mi" id="MathJax-Span-30623" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1000.82em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.822em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="munderover" id="MathJax-Span-30624" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-30625" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1001.13em, 4.255em, -999.997em); top: -2.918em; left: 0.156em;"><span class="texatom" id="MathJax-Span-30626"><span class="mrow" id="MathJax-Span-30627"><span class="mi" id="MathJax-Span-30628" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-30629" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-30630" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.281em, 1000.51em, 4.152em, -999.997em); top: -5.12em; left: 0.464em;"><span class="mi" id="MathJax-Span-30631" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="munderover" id="MathJax-Span-30632" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 4.767em; height: 0px;"><span style="position: absolute; clip: rect(2.871em, 1001.39em, 4.613em, -999.997em); top: -3.993em; left: 1.642em;"><span class="mo" id="MathJax-Span-30633" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1004.72em, 4.408em, -999.997em); top: -2.866em; left: 0em;"><span class="texatom" id="MathJax-Span-30634"><span class="mrow" id="MathJax-Span-30635"><span class="mo" id="MathJax-Span-30636" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-30637" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-30638" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-30639" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-30640" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-30641" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mo" id="MathJax-Span-30642" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-30643" style="font-size: 70.7%; font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-30644" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-30645" style="font-size: 70.7%; font-family: MathJax_Main;">≠</span><span class="mn" id="MathJax-Span-30646" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-30647" style="font-family: MathJax_Main; padding-left: 0.156em;">log</span><span class="mo" id="MathJax-Span-30648"></span><span class="mo" id="MathJax-Span-30649" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-30650" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-30651" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-30652"><span style="display: inline-block; position: relative; width: 1.898em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-30653" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-30654"><span class="mrow" id="MathJax-Span-30655"><span class="mi" id="MathJax-Span-30656" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-30657" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-30658" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-30659"><span class="mrow" id="MathJax-Span-30660"><span class="mo" id="MathJax-Span-30661" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-30662"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-30663" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-30664" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-30665" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-30666" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-30667" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.747em; border-left: 0px solid; width: 0px; height: 3.941em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>T</mi></mfrac><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></munderover><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mi>m</mi><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>m</mi><mo>,</mo><mtext>&nbsp;</mtext><mi>j</mi><mo>≠</mo><mn>0</mn></mrow></munder><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mi>j</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>w</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1634">J(\theta)=−\frac{1}{T} \sum_{t = 1}^T \sum_{-m \le j \le m,\ j \ne 0} \log(p(w_{t + j} | w_t)),</script></span><br>
где<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1635-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30668" style="width: 0.822em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.67em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-30669"><span class="mi" id="MathJax-Span-30670" style="font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-1635">T</script></span> – размер словаря;<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1636-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mi>t</mi></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30671" style="width: 1.283em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1001.03em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-30672"><span class="msubsup" id="MathJax-Span-30673"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-30674" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-30675" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-1636">w_t</script></span> – текущее слово и мы пытаемся найти вероятность, что другое слово, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1637-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>j</mi></mrow></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30676" style="width: 2.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.898em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1001.9em, 2.666em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-30677"><span class="msubsup" id="MathJax-Span-30678"><span style="display: inline-block; position: relative; width: 1.898em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-30679" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-30680"><span class="mrow" id="MathJax-Span-30681"><span class="mi" id="MathJax-Span-30682" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-30683" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-30684" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-1637">w_{t + j}</script></span> появится с текущим в одном окне, то есть среди <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1638-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo>&amp;#x00B1;</mo><mi>m</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30685" style="width: 2.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1001.64em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-30686"><span class="mo" id="MathJax-Span-30687" style="font-family: MathJax_Main;">±</span><span class="mi" id="MathJax-Span-30688" style="font-family: MathJax_Math; font-style: italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>±</mo><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-1638">\pm m</script></span> слов вокруг;<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1639-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30689" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-30690"><span class="mi" id="MathJax-Span-30691" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-1639">\theta</script></span> – векторные представления слов, которые мы ищем.</p><h3 id="CBOW-Skip-gram"><a class="anchor hidden-xs" href="#CBOW-Skip-gram" title="CBOW-Skip-gram"><span class="octicon octicon-link"></span></a>CBOW, Skip-gram</h3><p><a href="https://towardsdatascience.com/beyond-word-embeddings-part-2-word-vectors-nlp-modeling-from-bow-to-bert-4ebd4711d0ec" target="_blank" rel="noopener">Источник того, что ниже.</a><br>
There are two main Word2Vec architectures that are used to produce a distributed representation of words:</p><ul>
<li><strong>Continuous bag-of-words (CBOW)</strong>  — The order of context words does not influence prediction (bag-of-words assumption). In the continuous skip-gram architecture, the model uses the current word to predict the surrounding window of context words.</li>
<li><strong>Continuous skip-gram</strong> weighs nearby context words more heavily than more distant context words. While order still is not captured each of the context vectors are weighed and compared independently vs CBOW which weighs against the average context.</li>
</ul><p>CBOW is faster while skip-gram is slower but does a better job for infrequent words.</p><p>Еще раз, но на русском, <a href="https://ru.wikipedia.org/wiki/Word2vec" target="_blank" rel="noopener">скопировано отсюда</a>:<br>
В word2vec существуют два основных алгоритма обучения: CBOW и Skip-gram:</p><ul>
<li><strong>Skip-gram</strong> использует текущее слово, чтобы предугадывать окружающие его слова.  <p>
    <img src="https://github.com/natalymr/dl-notes/blob/master/pictures/question_7/skip_gram.png?raw=true">
  </p>
</li>
<li><strong>CBOW</strong> — «непрерывный мешок со словами» модельная архитектура, которая предсказывает текущее слово, исходя из окружающего его контекста.  <p>
    <img src="https://github.com/natalymr/dl-notes/blob/master/pictures/question_7/cbow.png?raw=true">
  </p>
</li>
</ul><p><em>Порядок слов контекста не оказывает влияния на результат ни в одном из этих алгоритмов.</em></p><p>
  <img src="https://github.com/natalymr/dl-notes/blob/master/pictures/question_7/cbow_skip_gram.png?raw=true">
</p><h3 id="GloVe"><a class="anchor hidden-xs" href="#GloVe" title="GloVe"><span class="octicon octicon-link"></span></a>GloVe</h3><p><a href="https://lilianweng.github.io/lil-log/2017/10/15/learning-word-embedding.html#glove-global-vectors" target="_blank" rel="noopener">Источник того, что ниже.</a><br>
<strong>The Global Vector (GloVe)</strong> model proposed by Pennington et al. (2014) aims <em>to combine the count-based matrix factorization and the context-based skip-gram model together</em>.</p><p>We all know the counts and co-occurrences can reveal the meanings of words. To distinguish from <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1640-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mi>O</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>w</mi><mi>I</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30692" style="width: 4.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.998em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.9em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-30693"><span class="mi" id="MathJax-Span-30694" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-30695" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-30696"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-30697" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-30698" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">O</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-30699"><span class="mrow" id="MathJax-Span-30700"><span class="mo" id="MathJax-Span-30701" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-30702"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-30703" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-30704" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-30705" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>O</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>w</mi><mi>I</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1640">p(w_O|w_I)</script></span> in the context of a word embedding word, we would like to define the co-ocurrence probability as:</p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1666-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>o</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mi>k</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mi>i</mi></msub><mo>,</mo><msub><mi>w</mi><mi>k</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31453" style="width: 12.605em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.3em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.566em, 1010.3em, 3.332em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-31454"><span class="msubsup" id="MathJax-Span-31455"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-31456" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="texatom" id="MathJax-Span-31457"><span class="mrow" id="MathJax-Span-31458"><span class="mi" id="MathJax-Span-31459" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-31460" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">o</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-31461" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-31462"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-31463" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-31464" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-31465"><span class="mrow" id="MathJax-Span-31466"><span class="mo" id="MathJax-Span-31467" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-31468"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-31469" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-31470" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-31471" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-31472" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mfrac" id="MathJax-Span-31473" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 4.306em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.076em, 1004.05em, 4.408em, -999.997em); top: -4.711em; left: 50%; margin-left: -2.098em;"><span class="mrow" id="MathJax-Span-31474"><span class="mi" id="MathJax-Span-31475" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-31476" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-31477"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-31478" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-31479" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-31480" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-31481" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-31482" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-31483" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-31484" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.076em, 1002.46em, 4.408em, -999.997em); top: -3.276em; left: 50%; margin-left: -1.278em;"><span class="mrow" id="MathJax-Span-31485"><span class="mi" id="MathJax-Span-31486" style="font-family: MathJax_Math; font-style: italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-31487" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-31488"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-31489" style="font-family: MathJax_Math; font-style: italic;">w</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="mi" id="MathJax-Span-31490" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-31491" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1004.31em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.306em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>o</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>w</mi><mi>k</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>w</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>C</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo>,</mo><msub><mi>w</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mi>C</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1666">p_{co}(w_k|w_i)=\frac{C(w_i,w_k)}{C(w_i)}</script></span></p><p>
  <img src="https://github.com/natalymr/dl-notes/blob/master/pictures/question_7/glove.png?raw=true">
</p><p>Получив матрицу совместной встречаемости, <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1685-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31543" style="width: 1.027em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.82em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-31544"><span class="mi" id="MathJax-Span-31545" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-1685">X</script></span>, необходимо проделать следующие шаги:</p><p>
  <img src="https://github.com/natalymr/dl-notes/blob/master/pictures/question_7/glove1.png?raw=true">
</p><p><a href="https://docs.google.com/document/d/1BnfFRAGzioCf1b8n1MQbIb54m0t5moQPUAlYQ5xkOzA/edit" target="_blank" rel="noopener">Источник того, что ниже - лекции.</a><br>
Здесь снова появляется матрица совместной встречаемости, и от нее берем логарифм и умножаем на функцию, которая ограничивает совместную встречаемость. То есть это сделано, чтобы слова, которые встречаются очень часто, не давали очень большую ошибку.<br>
GloVE хорош тем, что  есть в общем доступе вектора, натренированные на большом количестве датасетов.</p><h3 id="FastText"><a class="anchor hidden-xs" href="#FastText" title="FastText"><span class="octicon octicon-link"></span></a>FastText</h3><p><a href="" target="_blank" rel="noopener">Источник того, что ниже - лекции.</a><br>
Сейчас используют алгоритм FastText, суть которого состоит в следующем:<br>
вместе одного слова добавим в словарь ещё и все его n-граммы. Ниже кроме слова where мы добавим в словарь его три-граммы.<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1747-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mtext>&amp;#xA0;</mtext><mtext>&amp;#xA0;</mtext><mo>&amp;lt;</mo><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mo>&amp;gt;</mo><mtext>&amp;#xA0;</mtext><mo>+</mo><mtext>&amp;#xA0;</mtext><mo>&amp;lt;</mo><mi>w</mi><mi>h</mi><mo>+</mo><mi>w</mi><mi>h</mi><mi>e</mi><mo>+</mo><mi>h</mi><mi>e</mi><mi>r</mi><mo>+</mo><mi>e</mi><mi>r</mi><mi>e</mi><mo>+</mo><mi>r</mi><mi>e</mi><mo>&amp;gt;</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32673" style="width: 31.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1025.41em, 2.462em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-32674"><span class="mi" id="MathJax-Span-32675" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mi" id="MathJax-Span-32676" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-32677" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-32678" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-32679" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-32680" style="font-family: MathJax_Main; padding-left: 0.259em;">→</span><span class="mtext" id="MathJax-Span-32681" style="font-family: MathJax_Main; padding-left: 0.259em;">&nbsp;</span><span class="mtext" id="MathJax-Span-32682" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-32683" style="font-family: MathJax_Main; padding-left: 0.259em;">&lt;</span><span class="mi" id="MathJax-Span-32684" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.259em;">w</span><span class="mi" id="MathJax-Span-32685" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-32686" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-32687" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-32688" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-32689" style="font-family: MathJax_Main; padding-left: 0.259em;">&gt;</span><span class="mtext" id="MathJax-Span-32690" style="font-family: MathJax_Main; padding-left: 0.259em;">&nbsp;</span><span class="mo" id="MathJax-Span-32691" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mtext" id="MathJax-Span-32692" style="font-family: MathJax_Main; padding-left: 0.207em;">&nbsp;</span><span class="mo" id="MathJax-Span-32693" style="font-family: MathJax_Main; padding-left: 0.259em;">&lt;</span><span class="mi" id="MathJax-Span-32694" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.259em;">w</span><span class="mi" id="MathJax-Span-32695" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mo" id="MathJax-Span-32696" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-32697" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">w</span><span class="mi" id="MathJax-Span-32698" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mi" id="MathJax-Span-32699" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-32700" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-32701" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">h</span><span class="mi" id="MathJax-Span-32702" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-32703" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-32704" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-32705" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">e</span><span class="mi" id="MathJax-Span-32706" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-32707" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-32708" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-32709" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">r</span><span class="mi" id="MathJax-Span-32710" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-32711" style="font-family: MathJax_Main; padding-left: 0.259em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mo stretchy="false">→</mo><mtext>&nbsp;</mtext><mtext>&nbsp;</mtext><mo>&lt;</mo><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mo>&gt;</mo><mtext>&nbsp;</mtext><mo>+</mo><mtext>&nbsp;</mtext><mo>&lt;</mo><mi>w</mi><mi>h</mi><mo>+</mo><mi>w</mi><mi>h</mi><mi>e</mi><mo>+</mo><mi>h</mi><mi>e</mi><mi>r</mi><mo>+</mo><mi>e</mi><mi>r</mi><mi>e</mi><mo>+</mo><mi>r</mi><mi>e</mi><mo>&gt;</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1747">where \rightarrow\ \ <where>\ +\ <wh + whe + her + ere + re></script></span></p><p>Зачем это нужно?<br>
Если не использовать стемминг, то у одного слова может появиться огромное количество производных, которые размазывают представление о смысле и негативно влияет на совместную встречаемость. А стемминг убивает синтаксические связи, которые важны.</p><p>С fasttext получается, что вместо одного вектора для каждого слова у нас их много, можно уловить соотношения, потому что одни вектора несут информацию о смысле слова, другие о его строении. А что еще замечательно в алгоритме – он дает представление о тех словах, которые мы не встречали и на которых не обучались.</p><p>
  <img src="https://github.com/natalymr/dl-notes/blob/master/pictures/question_7/embed_results.png?raw=true">
</p><p>Есть разные метрики: семантическая точность и синтаксическая точность. Тут приведены сравнения разных алгоритмов. Интересно, что даже если разница большая на тестовой выборке, то при применении к конкретной задаче разница ошибок сильно сокращается с <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1740-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>7</mn><mi mathvariant=&quot;normal&quot;>&amp;#x0025;</mi><mo>&amp;#x2212;</mo><mn>70</mn><mi mathvariant=&quot;normal&quot;>&amp;#x0025;</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32477" style="width: 5.33em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.357em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1004.31em, 2.462em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-32478"><span class="mn" id="MathJax-Span-32479" style="font-family: MathJax_Main;">7</span><span class="mi" id="MathJax-Span-32480" style="font-family: MathJax_Main;">%</span><span class="mo" id="MathJax-Span-32481" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mn" id="MathJax-Span-32482" style="font-family: MathJax_Main; padding-left: 0.207em;">70</span><span class="mi" id="MathJax-Span-32483" style="font-family: MathJax_Main;">%</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>7</mn><mi mathvariant="normal">%</mi><mo>−</mo><mn>70</mn><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-1740">7\%-70\%</script></span> до разницы в <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1741-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>5</mn><mi mathvariant=&quot;normal&quot;>&amp;#x0025;</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32484" style="width: 1.642em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.335em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1001.28em, 2.41em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-32485"><span class="mn" id="MathJax-Span-32486" style="font-family: MathJax_Main;">5</span><span class="mi" id="MathJax-Span-32487" style="font-family: MathJax_Main;">%</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-1741">5\%</script></span>.</p><h2 id="Вопрос-2-Deep-Reinforcement-Learning-Deep-Q-Network-Deep-Deterministic-Policy-Gradient"><a class="anchor hidden-xs" href="#Вопрос-2-Deep-Reinforcement-Learning-Deep-Q-Network-Deep-Deterministic-Policy-Gradient" title="Вопрос-2-Deep-Reinforcement-Learning-Deep-Q-Network-Deep-Deterministic-Policy-Gradient"><span class="octicon octicon-link"></span></a>Вопрос 2: Deep Reinforcement Learning: Deep Q-Network, Deep Deterministic Policy Gradient.</h2><p><strong>Обучение с подкреплением</strong> (reinforcement learning) — один из способов машинного обучения, в ходе которого испытуемая система (агент) обучается, взаимодействуя с некоторой средой. Откликом среды на принятые решения являются сигналы подкрепления, поэтому такое обучение является частным случаем обучения с учителем, но учителем является среда или её модель.</p><p><img src="https://www.kdnuggets.com/images/reinforcement-learning-fig1-700.jpg" alt="picture"></p><p><em>Основные параметры марковского процесса:</em></p><ul>
<li>Набор состояний S окружения</li>
<li>Набор действий агента A</li>
<li>Функция перехода из одного состояния в другое <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 4.818em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.947em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.85em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-5"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mo" id="MathJax-Span-7" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-8"><span class="mrow" id="MathJax-Span-9"><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1">P(s’ | s, a)</script></span><br>
– она может быть дискретной или вероятностной, и описывает вероятность/возможность перейти из одного состояния в другое при совершение действия <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x430;</mo></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-15" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1000.36em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-16"><span class="texatom" id="MathJax-Span-17"><span class="mrow" id="MathJax-Span-18"><span class="mo" id="MathJax-Span-19"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 82%; font-style: normal; font-weight: normal;">а</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>а</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-2">а</script></span></li>
<li>Функция награды <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-20" style="width: 5.023em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.101em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1004em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-21"><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math; font-style: italic;">R</span><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-28" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mo" id="MathJax-Span-30" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3">R(s, a, s’)</script></span><br>
– возвращающая награду за переход в состояние <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32" style="width: 0.873em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1000.72em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-33"><span class="msup" id="MathJax-Span-34"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mo" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>s</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-4">s’</script></span> после совершения действия <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x430;</mo></mrow></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-37" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1000.36em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-38"><span class="texatom" id="MathJax-Span-39"><span class="mrow" id="MathJax-Span-40"><span class="mo" id="MathJax-Span-41"><span style="font-family: STIXGeneral, &quot;Arial Unicode MS&quot;, serif; font-size: 82%; font-style: normal; font-weight: normal;">а</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>а</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-5">а</script></span> в состояние <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-42" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.41em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math; font-style: italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">s</script></span></li>
<li>Начальное состояние <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mn>0</mn></msub></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-45" style="width: 1.13em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.92em, 2.513em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-46"><span class="msubsup" id="MathJax-Span-47"><span style="display: inline-block; position: relative; width: 0.925em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mn" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-7">s_0</script></span></li>
<li>Дисконтирующий фактор <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-50" style="width: 0.669em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.591em, 1000.51em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">\gamma</script></span><br>
– описывающий то, насколько робот ценит выгоду, получаемую в будущем</li>
</ul><h3 id="Deep-Q-Network"><a class="anchor hidden-xs" href="#Deep-Q-Network" title="Deep-Q-Network"><span class="octicon octicon-link"></span></a>Deep Q-Network</h3><p>Функиця <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-53" style="width: 4.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.435em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.33em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-54"><span class="msubsup" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.771em;"><span class="mo" id="MathJax-Span-57" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>Q</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">Q^*(s, a)</script></span> означает то, какую максимальную награду можно получить, если начать действовать из этого состояния и совершить конкретное действие а, а дальше действовать оптимальным образом</p><p><a href="https://medium.freecodecamp.org/an-introduction-to-q-learning-reinforcement-learning-14ac0b4493cc" target="_blank" rel="noopener">Про <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-63" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.72em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-64"><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">Q</script></span>-learing</a><br>
<strong><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-66" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.72em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-67"><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">Q</script></span>-value</strong></p><p><img src="https://cdn-images-1.medium.com/max/800/1*YHjnBy5C4vfUX1yPoYTX7g.png" alt=""></p><pre><code>For each state s and action a do {
    Q'(s,a) = 0;
}
Do forever {
    Select action a and execute it in current state s;
    r = reward received;
    s' = new state;
    Q'(s,a) = (1-alpha) Q'(s,a) + alpha (r + gamma * max_a'  Q'(s',a'))
    s = s';
}
</code></pre><p><strong>Bellman Equation:</strong></p><p><img src="https://cdn-images-1.medium.com/max/1000/1*js8r4Aq2ZZoiLK0mMp_ocg.png" alt="ebellman"></p><p><strong>Q-Value Iteration:</strong><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mo>&amp;#x2217;</mo></msubsup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>(</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B3;</mi><mo>&amp;#x22C5;</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></msub><msubsup><mi>Q</mi><mi>k</mi><mo>&amp;#x2217;</mo></msubsup><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-69" style="width: 31.15em; display: inline-block;"><span style="display: inline-block; position: relative; width: 25.515em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1025.41em, 2.769em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-70"><span class="msubsup" id="MathJax-Span-71"><span style="display: inline-block; position: relative; width: 2.154em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.537em, 1000.41em, 4.152em, -999.997em); top: -4.301em; left: 0.771em;"><span class="mo" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1001.34em, 4.203em, -999.997em); top: -3.686em; left: 0.771em;"><span class="texatom" id="MathJax-Span-74"><span class="mrow" id="MathJax-Span-75"><span class="mi" id="MathJax-Span-76" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-78" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main; padding-left: 0.259em;">←</span><span class="munderover" id="MathJax-Span-85" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 1.642em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.03em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.686em; left: 1.078em;"><span class="texatom" id="MathJax-Span-87"><span class="mrow" id="MathJax-Span-88"><span class="msup" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.249em; left: 0.31em;"><span class="mo" id="MathJax-Span-91" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.105em;"></span></span><span class="mo" id="MathJax-Span-93" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-94"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mo" id="MathJax-Span-96" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-97"><span class="mrow" id="MathJax-Span-98"><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Math; font-style: italic;">R</span><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-111" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mo" id="MathJax-Span-113" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">m</span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="msubsup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="texatom" id="MathJax-Span-122"><span class="mrow" id="MathJax-Span-123"><span class="msup" id="MathJax-Span-124"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.36em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-125" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.198em; left: 0.361em;"><span class="mo" id="MathJax-Span-126" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-127"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.537em, 1000.41em, 4.152em, -999.997em); top: -4.301em; left: 0.771em;"><span class="mo" id="MathJax-Span-129" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.332em, 1000.46em, 4.152em, -999.997em); top: -3.686em; left: 0.771em;"><span class="mi" id="MathJax-Span-130" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-132"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-133" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mo" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-136" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.515em;"><span class="mo" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-140" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mo>∗</mo></msubsup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">←</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>s</mi><mo>′</mo></msup></mrow></munder><mi>P</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo>+</mo><mi>γ</mi><mo>⋅</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>a</mi><mo>′</mo></msup></mrow></msub><msubsup><mi>Q</mi><mi>k</mi><mo>∗</mo></msubsup><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo>,</mo><msup><mi>a</mi><mo>′</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">Q^*_{k+1}(s, a)\leftarrow\sum_{s'}P(s'|s, a)(R(s, a, s') + \gamma \cdot max_{a'}Q^*_k(s', a'))</script></span></p><p>Обучаем значения также, как Value Iteration:</p><ul>
<li>Задаем функци <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>Q</mi><mn>0</mn><mo>&amp;#x2217;</mo></msubsup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-141" style="width: 4.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.435em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.33em, 2.666em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-142"><span class="msubsup" id="MathJax-Span-143"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.537em, 1000.41em, 4.152em, -999.997em); top: -4.301em; left: 0.771em;"><span class="mo" id="MathJax-Span-145" style="font-size: 70.7%; font-family: MathJax_Main;">∗</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.686em; left: 0.771em;"><span class="mn" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>Q</mi><mn>0</mn><mo>∗</mo></msubsup><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-13">Q^*_0(s, a)</script></span> нулевые значения во всех состояниях.</li>
<li>Идем по всем состояниям и смотрим в какое состояние мы можем перейти с максимальной выгодой за один ход, т.е в каком из состояний <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-152" style="width: 0.873em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1000.72em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-153"><span class="msup" id="MathJax-Span-154"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mo" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>s</mi><mo>′</mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-14">s'</script></span> функция <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-157" style="width: 4.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.537em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.43em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-158"><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-161"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mo" id="MathJax-Span-163" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-165" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-166" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.515em;"><span class="mo" id="MathJax-Span-167" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-168" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo>,</mo><msup><mi>a</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15">Q(s', a')</script></span> максимальна.</li>
<li>Далее продолжаем процесс аналогичным образом, при с каждой <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-169" style="width: 0.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.361em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.386em, 1000.31em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-170"><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math; font-style: italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">i</script></span>-й итерацией мы считаем какую максимальную награду можно получить, если начать действовать из этого состояния и действовать оптимальным образом при этом совершая не больше i шагов.</li>
<li>Повторяем до сходимости.</li>
</ul><p><em>Value Iteration, Policy Iteration, доказательство сходимости</em> в вопросе нет(прямым текстом), но полагаю это важная часть, она норм расписана в конспектах</p><p><strong>Q-network</strong></p><p>Теперь расмотрим <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-172" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.72em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-173"><span class="mi" id="MathJax-Span-174" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">Q</script></span>-value network. На вход мы получаем интерпретацию состояния системы, например картинку экрана игры, на выходе сети мы получаем значения <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-175" style="width: 4.101em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.332em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1003.23em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-176"><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-179"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mi" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-184" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">Q(s_t, a)</script></span> для поданного на вход состояния и всех возможных ходов из него. После каждого хода в игре мы получаем четверку <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-185" style="width: 5.228em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.255em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1004.15em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-186"><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-190" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">r</span><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-194" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mo" id="MathJax-Span-196" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-197" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>′</mo></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-19">(s, a, r, s')</script></span>. По истечении некоторого количества ходов мы скармливаем эти четверки нашей сетке.</p><p><img src="https://leonardoaraujosantos.gitbooks.io/artificial-inteligence/content/image_folder_7/DQNBreakoutBlocks.png" alt="picture"></p><p><em>Loss function</em><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>,</mo><mi>a</mi><mo>&amp;#x223C;</mo><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><msub><mi>&amp;#x03B8;</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-198" style="width: 18.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.218em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.232em, 1015.12em, 2.718em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-199"><span class="msubsup" id="MathJax-Span-200"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-201" style="font-family: MathJax_Math; font-style: italic;">L</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-203" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-204"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-205" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mi" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-208" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="msubsup" id="MathJax-Span-209" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 3.384em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.77em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-210" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.788em; left: 0.72em;"><span class="texatom" id="MathJax-Span-211"><span class="mrow" id="MathJax-Span-212"><span class="mi" id="MathJax-Span-213" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-214" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-215" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-216" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="mi" id="MathJax-Span-217" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ρ</span><span class="mo" id="MathJax-Span-218" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-219" style="font-size: 70.7%; font-family: MathJax_Main;">⋅</span><span class="mo" id="MathJax-Span-220" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-222" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-223"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-224" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-225" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">Q</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-233" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mi" id="MathJax-Span-235" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-237"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.412em;"><span class="mn" id="MathJax-Span-239" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mo>,</mo><mi>a</mi><mo>∼</mo><mi>ρ</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><msub><mi>θ</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-20">L_i(\theta_i)=E_{s,a\sim\rho(\cdot)}[(y_i-Q(s,a;\theta_i))^2]</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x223C;</mo><mi>&amp;#x03B5;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>r</mi><mo>+</mo><mi>&amp;#x03B3;</mi><mo>&amp;#x22C5;</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></msub><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo>;</mo><msub><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-241" style="width: 22.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.035em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1017.93em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-242"><span class="msubsup" id="MathJax-Span-243"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-245" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-246" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="msubsup" id="MathJax-Span-247" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 2.205em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.77em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-249"><span class="mrow" id="MathJax-Span-250"><span class="msup" id="MathJax-Span-251"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-252" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.198em; left: 0.31em;"><span class="mo" id="MathJax-Span-253" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-254" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ε</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-256" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-260" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-261" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">m</span><span class="mi" id="MathJax-Span-262" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="msubsup" id="MathJax-Span-263"><span style="display: inline-block; position: relative; width: 1.232em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.566em;"><span class="texatom" id="MathJax-Span-265"><span class="mrow" id="MathJax-Span-266"><span class="msup" id="MathJax-Span-267"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.36em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-268" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.198em; left: 0.361em;"><span class="mo" id="MathJax-Span-269" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-271" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-272"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mo" id="MathJax-Span-274" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-275" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-276" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.515em;"><span class="mo" id="MathJax-Span-278" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-280" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 2.001em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.771em;"><span class="texatom" id="MathJax-Span-282"><span class="mrow" id="MathJax-Span-283"><span class="mi" id="MathJax-Span-284" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-285" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-286" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-288"><span class="mrow" id="MathJax-Span-289"><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-291" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-292" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-294" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>s</mi><mo>′</mo></msup><mo>∼</mo><mi>ε</mi></mrow></msub><mo stretchy="false">[</mo><mi>r</mi><mo>+</mo><mi>γ</mi><mo>⋅</mo><mi>m</mi><mi>a</mi><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>a</mi><mo>′</mo></msup></mrow></msub><mi>Q</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo>,</mo><msup><mi>a</mi><mo>′</mo></msup><mo>;</mo><msub><mi>Q</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-21">y_i=E_{s'\sim\varepsilon}[r+\gamma\cdot max_{a'}Q(s',a';Q_{i-1})|s,a]</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mi>i</mi></msub></mrow></msub><msub><mi>L</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03B8;</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>,</mo><mi>a</mi><mo>&amp;#x223C;</mo><mi>&amp;#x03C1;</mi><mo>;</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x223C;</mo><mi>&amp;#x03B5;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mo stretchy=&quot;false&quot;>(</mo><mi>r</mi><mo>+</mo><mi>&amp;#x03B3;</mi><mo>&amp;#x22C5;</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo>;</mo><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><msub><mi>&amp;#x03B8;</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mi>i</mi></msub></mrow></msub><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><msub><mi>&amp;#x03B8;</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-295" style="width: 39.654em; display: inline-block;"><span style="display: inline-block; position: relative; width: 32.482em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1032.38em, 2.666em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-296"><span class="msubsup" id="MathJax-Span-297"><span style="display: inline-block; position: relative; width: 1.488em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.77em, 4.203em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.822em;"><span class="texatom" id="MathJax-Span-299"><span class="mrow" id="MathJax-Span-300"><span class="msubsup" id="MathJax-Span-301"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-302" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.31em;"><span class="mi" id="MathJax-Span-303" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-304"><span style="display: inline-block; position: relative; width: 1.027em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.67em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-305" style="font-family: MathJax_Math; font-style: italic;">L</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.669em;"><span class="mi" id="MathJax-Span-306" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-308"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mi" id="MathJax-Span-310" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-311" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="msubsup" id="MathJax-Span-313" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 4.255em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.77em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.72em;"><span class="texatom" id="MathJax-Span-315"><span class="mrow" id="MathJax-Span-316"><span class="mi" id="MathJax-Span-317" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-318" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-319" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-320" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="mi" id="MathJax-Span-321" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ρ</span><span class="mo" id="MathJax-Span-322" style="font-size: 70.7%; font-family: MathJax_Main;">;</span><span class="msup" id="MathJax-Span-323"><span style="display: inline-block; position: relative; width: 0.515em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-324" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.198em; left: 0.31em;"><span class="mo" id="MathJax-Span-325" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-326" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="mi" id="MathJax-Span-327" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ε</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-329" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-332" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-333" style="font-family: MathJax_Main; padding-left: 0.207em;">⋅</span><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">m</span><span class="mi" id="MathJax-Span-335" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main;">(</span><span class="msup" id="MathJax-Span-339"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mo" id="MathJax-Span-341" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-342" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-343" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.515em;"><span class="mo" id="MathJax-Span-345" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-347" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.693em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="texatom" id="MathJax-Span-349"><span class="mrow" id="MathJax-Span-350"><span class="mi" id="MathJax-Span-351" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-352" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-353" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-354" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">Q</span><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-358" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-359" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-361" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-362" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mi" id="MathJax-Span-364" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-365" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-366" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-367"><span style="display: inline-block; position: relative; width: 1.488em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.77em, 4.203em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-368" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.822em;"><span class="texatom" id="MathJax-Span-369"><span class="mrow" id="MathJax-Span-370"><span class="msubsup" id="MathJax-Span-371"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-372" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.31em;"><span class="mi" id="MathJax-Span-373" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-375" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-377" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-379" style="font-family: MathJax_Main;">;</span><span class="msubsup" id="MathJax-Span-380" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mi" id="MathJax-Span-382" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-383" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-384" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>θ</mi><mi>i</mi></msub></mrow></msub><msub><mi>L</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msub><mi>θ</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mo>,</mo><mi>a</mi><mo>∼</mo><mi>ρ</mi><mo>;</mo><msup><mi>s</mi><mo>′</mo></msup><mo>∼</mo><mi>ε</mi></mrow></msub><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi>r</mi><mo>+</mo><mi>γ</mi><mo>⋅</mo><mi>m</mi><mi>a</mi><mi>x</mi><mi>Q</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>′</mo></msup><mo>,</mo><msup><mi>a</mi><mo>′</mo></msup><mo>;</mo><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>−</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><msub><mi>θ</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>θ</mi><mi>i</mi></msub></mrow></msub><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><msub><mi>θ</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">\nabla_{\theta_i}L_i(\theta_i)=E_{s,a\sim\rho;s'\sim\varepsilon}[(r + \gamma\cdot maxQ(s',a';\theta_{i-1})-Q(s,a;\theta_i))\nabla_{\theta_i}Q(s,a;\theta_i)]</script></span></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-385" style="width: 0.566em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.464em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.46em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-386"><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Math; font-style: italic;">θ</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>θ</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">\theta</script></span>-веса сетки, внезапно</p><p>Тут есть большой недостаток - конечное число действий</p><p><a href="https://cdn-images-1.medium.com/max/1000/1*Zplt-1wTWu_7BGmZCBFjbQ.png" target="_blank" rel="noopener">Картинка в других обозначениях, где объяснено где что в градиенте</a></p><h3 id="Deep-Deterministic-Policy-Gradient"><a class="anchor hidden-xs" href="#Deep-Deterministic-Policy-Gradient" title="Deep-Deterministic-Policy-Gradient"><span class="octicon octicon-link"></span></a>Deep Deterministic Policy Gradient</h3><p>Он решает проблему с бесконечным множеством действий.<br>
Тут появляются две сущьности: Actor и Critic. Critic похож на предыдущую сетку и выдает <span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-388" style="width: 0.976em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.335em, 1000.72em, 2.564em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">Q</script></span>-value.</p><p>Actor принимает на вход текущее состояние и на выход дает число, представляющее действие выбраное из бесконечного пространства действий. Critic вычисляет Q-value текущего состояния и действия данного Actor.</p><p><img src="https://pemami4911.github.io/img/actor-critic.png" alt=""></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msup><mi>&amp;#x03B8;</mi><mi>Q</mi></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-391" style="width: 10.914em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.916em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1008.81em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-394" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-396" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-399" style="font-family: MathJax_Main; padding-left: 0.259em;">→</span><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.259em;">Q</span><span class="mo" id="MathJax-Span-401" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-403" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="texatom" id="MathJax-Span-405"><span class="mrow" id="MathJax-Span-406"><span class="mo" id="MathJax-Span-407" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-408"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-409" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mi" id="MathJax-Span-410" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-411" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">→</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mi>θ</mi><mi>Q</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-25">Q(s,a)\rightarrow Q(s, a|\theta^Q)</script></span>-critic<br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BC;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=&quot;false&quot;>(</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mi>&amp;#x03BC;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03BC;</mi></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-412" style="width: 15.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.759em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.283em, 1012.66em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-413"><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Math; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-416" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-417" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-418" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mi" id="MathJax-Span-419" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.259em;">a</span><span class="mi" id="MathJax-Span-420" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-423" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-425" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-428" style="font-family: MathJax_Main; padding-left: 0.259em;">→</span><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.259em;">μ</span><span class="mo" id="MathJax-Span-430" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-431" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="texatom" id="MathJax-Span-432"><span class="mrow" id="MathJax-Span-433"><span class="mo" id="MathJax-Span-434" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-435"><span style="display: inline-block; position: relative; width: 0.976em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="texatom" id="MathJax-Span-437"><span class="mrow" id="MathJax-Span-438"><span class="mi" id="MathJax-Span-439" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">μ</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-440" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo><mo stretchy="false">→</mo><mi>μ</mi><mo stretchy="false">(</mo><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>μ</mi></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">\mu(s)=argmax(Q)\rightarrow \mu(s|\theta^{\mu})</script></span>-actor</p><p><strong>Critic</strong></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>&amp;#x2211;</mo><mi>i</mi></munder><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msup><mi>&amp;#x03B8;</mi><mi>Q</mi></msup><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-441" style="width: 15.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.759em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1012.66em, 2.769em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-442"><span class="mi" id="MathJax-Span-443" style="font-family: MathJax_Math; font-style: italic;">L</span><span class="mo" id="MathJax-Span-444" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="mfrac" id="MathJax-Span-445" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px; margin-right: 0.105em; margin-left: 0.105em;"><span style="position: absolute; clip: rect(3.384em, 1000.31em, 4.152em, -999.997em); top: -4.403em; left: 50%; margin-left: -0.151em;"><span class="mn" id="MathJax-Span-446" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(3.384em, 1000.62em, 4.152em, -999.997em); top: -3.584em; left: 50%; margin-left: -0.305em;"><span class="mi" id="MathJax-Span-447" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; clip: rect(0.873em, 1000.77em, 1.232em, -999.997em); top: -1.278em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.771em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.078em;"></span></span></span></span><span class="munderover" id="MathJax-Span-448" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 1.386em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1001.03em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.686em; left: 1.078em;"><span class="mi" id="MathJax-Span-450" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-452"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-453" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-454" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main; padding-left: 0.207em;">−</span><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">Q</span><span class="mo" id="MathJax-Span-457" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-458"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-459" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mi" id="MathJax-Span-460" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-462" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-463" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-464" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-465"><span class="mrow" id="MathJax-Span-466"><span class="mo" id="MathJax-Span-467" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-468"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-469" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mi" id="MathJax-Span-470" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-471"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.31em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="mo" id="MathJax-Span-472" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.412em;"><span class="mn" id="MathJax-Span-473" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>∑</mo><mi>i</mi></munder><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mi>θ</mi><mi>Q</mi></msup><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-27">L=\frac{1}{N}\sum_i(y_i-Q(s_i,a_i|\theta^Q)^2)</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>r</mi><mi>i</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><msup><mi>Q</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msup><mi>&amp;#x03BC;</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>&amp;#x03BC;</mi><mo>&amp;#x2032;</mo></msup></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>Q</mi><mo>&amp;#x2032;</mo></msup></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-475" style="width: 18.189em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.91em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.13em, 1014.81em, 2.615em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-476"><span class="msubsup" id="MathJax-Span-477"><span style="display: inline-block; position: relative; width: 0.822em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.51em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.515em;"><span class="mi" id="MathJax-Span-479" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-480" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span><span class="msubsup" id="MathJax-Span-481" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math; font-style: italic;">r</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="mi" id="MathJax-Span-483" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-484" style="font-family: MathJax_Main; padding-left: 0.207em;">+</span><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.207em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msup" id="MathJax-Span-486"><span style="display: inline-block; position: relative; width: 1.078em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.72em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-487" style="font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.771em;"><span class="mo" id="MathJax-Span-488" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-489" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-490"><span style="display: inline-block; position: relative; width: 1.693em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-491" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="texatom" id="MathJax-Span-492"><span class="mrow" id="MathJax-Span-493"><span class="mi" id="MathJax-Span-494" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-495" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-496" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-497" style="font-family: MathJax_Main;">,</span><span class="msup" id="MathJax-Span-498" style="padding-left: 0.156em;"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.57em, 4.357em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.617em;"><span class="mo" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-501" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-502"><span style="display: inline-block; position: relative; width: 1.693em; height: 0px;"><span style="position: absolute; clip: rect(3.384em, 1000.41em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.464em;"><span class="texatom" id="MathJax-Span-504"><span class="mrow" id="MathJax-Span-505"><span class="mi" id="MathJax-Span-506" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-507" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-508" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-509"><span class="mrow" id="MathJax-Span-510"><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-512"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-513" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="texatom" id="MathJax-Span-514"><span class="mrow" id="MathJax-Span-515"><span class="msup" id="MathJax-Span-516"><span style="display: inline-block; position: relative; width: 0.617em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.41em, 4.306em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-517" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.249em; left: 0.412em;"><span class="mo" id="MathJax-Span-518" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-519" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-520"><span class="mrow" id="MathJax-Span-521"><span class="mo" id="MathJax-Span-522" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-523"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-524" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="texatom" id="MathJax-Span-525"><span class="mrow" id="MathJax-Span-526"><span class="msup" id="MathJax-Span-527"><span style="display: inline-block; position: relative; width: 0.771em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.51em, 4.306em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-528" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.301em; left: 0.566em;"><span class="mo" id="MathJax-Span-529" style="font-size: 50%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-530" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>r</mi><mi>i</mi></msub><mo>+</mo><mi>γ</mi><msup><mi>Q</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msup><mi>μ</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>μ</mi><mo>′</mo></msup></mrow></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>Q</mi><mo>′</mo></msup></mrow></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-28">y_i=r_i+\gamma Q'(s_{i+1},\mu'(s_{i+1}|\theta^{\mu'})|\theta^{Q'})</script></span></p><p><strong>Actor(<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-531" style="width: 0.72em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.642em, 1000.57em, 2.359em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-532"><span class="mi" id="MathJax-Span-533" style="font-family: MathJax_Math; font-style: italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">\pi</script></span>)</strong></p><p><span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03BC;</mi></mrow></msup></mrow></msub><mi>&amp;#x03BC;</mi><mo>&amp;#x2248;</mo><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>t</mi></msub><mo>&amp;#x223C;</mo><msup><mi>&amp;#x03C1;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B2;</mi></mrow></msup></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03BC;</mi></mrow></msup></mrow></msub><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msup><mi>&amp;#x03B8;</mi><mi>Q</mi></msup><mo stretchy=&quot;false&quot;>)</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>=</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo>=</mo><mi>&amp;#x03BC;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03BC;</mi></mrow></msup><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-534" style="width: 23.21em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.009em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1018.96em, 2.82em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-535"><span class="msubsup" id="MathJax-Span-536"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.77em, 4.203em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-537" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.788em; left: 0.822em;"><span class="texatom" id="MathJax-Span-538"><span class="mrow" id="MathJax-Span-539"><span class="msubsup" id="MathJax-Span-540"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-541" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.301em; left: 0.31em;"><span class="texatom" id="MathJax-Span-542"><span class="mrow" id="MathJax-Span-543"><span class="mi" id="MathJax-Span-544" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">μ</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-545" style="font-family: MathJax_Math; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-546" style="font-family: MathJax_Main; padding-left: 0.259em;">≈</span><span class="msubsup" id="MathJax-Span-547" style="padding-left: 0.259em;"><span style="display: inline-block; position: relative; width: 2.615em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.77em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.788em; left: 0.72em;"><span class="texatom" id="MathJax-Span-549"><span class="mrow" id="MathJax-Span-550"><span class="msubsup" id="MathJax-Span-551"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-552" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.31em;"><span class="mi" id="MathJax-Span-553" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-554" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-555"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.36em, 4.306em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-556" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ρ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.198em; left: 0.361em;"><span class="texatom" id="MathJax-Span-557"><span class="mrow" id="MathJax-Span-558"><span class="mi" id="MathJax-Span-559" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-560" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-561"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.77em, 4.203em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-562" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.788em; left: 0.822em;"><span class="texatom" id="MathJax-Span-563"><span class="mrow" id="MathJax-Span-564"><span class="msubsup" id="MathJax-Span-565"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-566" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.301em; left: 0.31em;"><span class="texatom" id="MathJax-Span-567"><span class="mrow" id="MathJax-Span-568"><span class="mi" id="MathJax-Span-569" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">μ</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-570" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-571" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-572" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-573" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-574" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="texatom" id="MathJax-Span-575"><span class="mrow" id="MathJax-Span-576"><span class="mo" id="MathJax-Span-577" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-578"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-579" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mi" id="MathJax-Span-580" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-581" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-582"><span style="display: inline-block; position: relative; width: 5.33em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.16em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-583"><span class="mrow" id="MathJax-Span-584"><span class="mo" id="MathJax-Span-585" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.686em; left: 0.259em;"><span class="texatom" id="MathJax-Span-586"><span class="mrow" id="MathJax-Span-587"><span class="mi" id="MathJax-Span-588" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-589" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="msubsup" id="MathJax-Span-590"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-591" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.31em;"><span class="mi" id="MathJax-Span-592" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-593" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-594" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-595" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-596" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-597" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-598"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-599" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.31em;"><span class="mi" id="MathJax-Span-600" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="texatom" id="MathJax-Span-601"><span class="mrow" id="MathJax-Span-602"><span class="mo" id="MathJax-Span-603" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-604"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-605" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.301em; left: 0.31em;"><span class="texatom" id="MathJax-Span-606"><span class="mrow" id="MathJax-Span-607"><span class="mi" id="MathJax-Span-608" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">μ</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-609" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-610" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-611" style="font-family: MathJax_Main; padding-left: 0.259em;">=</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.622em; border-left: 0px solid; width: 0px; height: 1.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>μ</mi></mrow></msup></mrow></msub><mi>μ</mi><mo>≈</mo><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mi>t</mi></msub><mo>∼</mo><msup><mi>ρ</mi><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msup></mrow></msub><mo stretchy="false">[</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>μ</mi></mrow></msup></mrow></msub><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mi>θ</mi><mi>Q</mi></msup><mo stretchy="false">)</mo><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mo>=</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo>=</mo><mi>μ</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>μ</mi></mrow></msup><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">]</mo><mo>=</mo></math></span></span><script type="math/tex" id="MathJax-Element-30">\nabla_{\theta^{\mu}}\mu\approx E_{s_t\sim\rho^{\beta}}[\nabla_{\theta^{\mu}}Q(s,a|\theta^Q)|_{s=s_t,a=\mu(s_t|\theta^{\mu})}] =</script></span><br>
<span class="mathjax"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>t</mi></msub><mo>&amp;#x223C;</mo><msup><mi>&amp;#x03C1;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B2;</mi></mrow></msup></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi></mrow></msub><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msup><mi>&amp;#x03B8;</mi><mi>Q</mi></msup><mo stretchy=&quot;false&quot;>)</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>=</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo>=</mo><mi>&amp;#x03BC;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03BC;</mi></mrow></msub></mrow></msub><mi>&amp;#x03BC;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>m</mi><mi>u</mi></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>=</mo><msub><mi>s</mi><mi>t</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-612" style="width: 24.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 20.443em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.181em, 1020.34em, 2.82em, -999.997em); top: -2.2em; left: 0em;"><span class="mrow" id="MathJax-Span-613"><span class="msubsup" id="MathJax-Span-614"><span style="display: inline-block; position: relative; width: 2.615em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.77em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-615" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.788em; left: 0.72em;"><span class="texatom" id="MathJax-Span-616"><span class="mrow" id="MathJax-Span-617"><span class="msubsup" id="MathJax-Span-618"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-619" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.31em;"><span class="mi" id="MathJax-Span-620" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-621" style="font-size: 70.7%; font-family: MathJax_Main;">∼</span><span class="msubsup" id="MathJax-Span-622"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.36em, 4.306em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-623" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">ρ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.198em; left: 0.361em;"><span class="texatom" id="MathJax-Span-624"><span class="mrow" id="MathJax-Span-625"><span class="mi" id="MathJax-Span-626" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-627" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-628"><span style="display: inline-block; position: relative; width: 1.283em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.77em, 4.203em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-629" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.822em;"><span class="texatom" id="MathJax-Span-630"><span class="mrow" id="MathJax-Span-631"><span class="mi" id="MathJax-Span-632" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-634" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-635" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-636" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-637" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.156em;">a</span><span class="texatom" id="MathJax-Span-638"><span class="mrow" id="MathJax-Span-639"><span class="mo" id="MathJax-Span-640" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-641"><span style="display: inline-block; position: relative; width: 1.13em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-642" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="mi" id="MathJax-Span-643" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Q</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-644" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-645"><span style="display: inline-block; position: relative; width: 4.46em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.16em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-646"><span class="mrow" id="MathJax-Span-647"><span class="mo" id="MathJax-Span-648" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.686em; left: 0.259em;"><span class="texatom" id="MathJax-Span-649"><span class="mrow" id="MathJax-Span-650"><span class="mi" id="MathJax-Span-651" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-652" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="msubsup" id="MathJax-Span-653"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-654" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.31em;"><span class="mi" id="MathJax-Span-655" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-656" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-657" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-658" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-659" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-660" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-661"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-662" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.31em;"><span class="mi" id="MathJax-Span-663" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-664" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-665"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.179em, 1000.77em, 4.203em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-666" style="font-family: MathJax_Main;">∇</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.822em;"><span class="texatom" id="MathJax-Span-667"><span class="mrow" id="MathJax-Span-668"><span class="msubsup" id="MathJax-Span-669"><span style="display: inline-block; position: relative; width: 0.669em; height: 0px;"><span style="position: absolute; clip: rect(3.332em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-670" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.31em;"><span class="texatom" id="MathJax-Span-671"><span class="mrow" id="MathJax-Span-672"><span class="mi" id="MathJax-Span-673" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">μ</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mi" id="MathJax-Span-674" style="font-family: MathJax_Math; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-675" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-676" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="texatom" id="MathJax-Span-677"><span class="mrow" id="MathJax-Span-678"><span class="mo" id="MathJax-Span-679" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-680"><span style="display: inline-block; position: relative; width: 1.591em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.46em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-681" style="font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -4.352em; left: 0.464em;"><span class="texatom" id="MathJax-Span-682"><span class="mrow" id="MathJax-Span-683"><span class="mi" id="MathJax-Span-684" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-685" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">u</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-686" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-687"><span style="display: inline-block; position: relative; width: 1.796em; height: 0px;"><span style="position: absolute; clip: rect(3.076em, 1000.16em, 4.408em, -999.997em); top: -3.993em; left: 0em;"><span class="texatom" id="MathJax-Span-688"><span class="mrow" id="MathJax-Span-689"><span class="mo" id="MathJax-Span-690" style="font-family: MathJax_Main;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.686em; left: 0.259em;"><span class="texatom" id="MathJax-Span-691"><span class="mrow" id="MathJax-Span-692"><span class="mi" id="MathJax-Span-693" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-694" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="msubsup" id="MathJax-Span-695"><span style="display: inline-block; position: relative; width: 0.566em; height: 0px;"><span style="position: absolute; clip: rect(3.537em, 1000.31em, 4.152em, -999.997em); top: -3.993em; left: 0em;"><span class="mi" id="MathJax-Span-696" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span><span style="position: absolute; top: -3.891em; left: 0.31em;"><span class="mi" id="MathJax-Span-697" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">t</span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.998em;"></span></span></span></span><span class="mo" id="MathJax-Span-698" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.622em; border-left: 0px solid; width: 0px; height: 1.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mi>t</mi></msub><mo>∼</mo><msup><mi>ρ</mi><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msup></mrow></msub><mo stretchy="false">[</mo><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><mi>a</mi></mrow></msub><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mi>θ</mi><mi>Q</mi></msup><mo stretchy="false">)</mo><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mo>=</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><mi>a</mi><mo>=</mo><mi>μ</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></msub><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>μ</mi></mrow></msub></mrow></msub><mi>μ</mi><mo stretchy="false">(</mo><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msup><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mi>u</mi></mrow></msup><mo stretchy="false">)</mo><msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mo>=</mo><msub><mi>s</mi><mi>t</mi></msub></mrow></msub><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-31">E_{s_t\sim\rho^{\beta}}[\nabla_{a}Q(s,a|\theta^Q)|_{s=s_t,a=\mu(s_t)}\nabla_{\theta_{\mu}}\mu(s|\theta^{mu})|_{s=s_t}]</script></span></p><p><img src="https://static1.squarespace.com/static/58523b79cd0f68eedd3d0007/t/5aac16f51ae6cf8c22bdd009/1521227682873/Screen+Shot+2018-03-16+at+3.11.28+PM.png?format=750w" alt=""></p><p><a href="https://pemami4911.github.io/blog/2016/08/21/ddpg-rl.html" target="_blank" rel="noopener">Чуть более подробно</a></p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Билет-№7" title="Билет №7">Билет №7</a><ul class="nav">
<li class=""><a href="#Вопрос-1-Word-embeddings-Co-occurrence-Matrix-Word2Vec-CBOW-Skip-Gram-GloVE-FastText" title="Вопрос 1: Word embeddings: Co-occurrence Matrix, Word2Vec, CBOW, Skip-Gram, GloVE, FastText.">Вопрос 1: Word embeddings: Co-occurrence Matrix, Word2Vec, CBOW, Skip-Gram, GloVE, FastText.</a><ul class="nav">
<li><a href="#Word-embedding" title="Word embedding">Word embedding</a></li>
<li><a href="#Co-occurence-matrix" title="Co-occurence matrix">Co-occurence matrix</a></li>
<li><a href="#word2vec" title="word2vec">word2vec</a></li>
<li><a href="#CBOW-Skip-gram" title="CBOW, Skip-gram">CBOW, Skip-gram</a></li>
<li><a href="#GloVe" title="GloVe">GloVe</a></li>
<li class=""><a href="#FastText" title="FastText">FastText</a></li>
</ul>
</li>
<li><a href="#Вопрос-2-Deep-Reinforcement-Learning-Deep-Q-Network-Deep-Deterministic-Policy-Gradient" title="Вопрос 2: Deep Reinforcement Learning: Deep Q-Network, Deep Deterministic Policy Gradient.">Вопрос 2: Deep Reinforcement Learning: Deep Q-Network, Deep Deterministic Policy Gradient.</a><ul class="nav">
<li><a href="#Deep-Q-Network" title="Deep Q-Network">Deep Q-Network</a></li>
<li><a href="#Deep-Deterministic-Policy-Gradient" title="Deep Deterministic Policy Gradient">Deep Deterministic Policy Gradient</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;"  >
        <div class="toc"><ul class="nav">
<li class=""><a href="#Билет-№7" title="Билет №7">Билет №7</a><ul class="nav">
<li class=""><a href="#Вопрос-1-Word-embeddings-Co-occurrence-Matrix-Word2Vec-CBOW-Skip-Gram-GloVE-FastText" title="Вопрос 1: Word embeddings: Co-occurrence Matrix, Word2Vec, CBOW, Skip-Gram, GloVE, FastText.">Вопрос 1: Word embeddings: Co-occurrence Matrix, Word2Vec, CBOW, Skip-Gram, GloVE, FastText.</a><ul class="nav">
<li><a href="#Word-embedding" title="Word embedding">Word embedding</a></li>
<li><a href="#Co-occurence-matrix" title="Co-occurence matrix">Co-occurence matrix</a></li>
<li><a href="#word2vec" title="word2vec">word2vec</a></li>
<li><a href="#CBOW-Skip-gram" title="CBOW, Skip-gram">CBOW, Skip-gram</a></li>
<li><a href="#GloVe" title="GloVe">GloVe</a></li>
<li class=""><a href="#FastText" title="FastText">FastText</a></li>
</ul>
</li>
<li><a href="#Вопрос-2-Deep-Reinforcement-Learning-Deep-Q-Network-Deep-Deterministic-Policy-Gradient" title="Вопрос 2: Deep Reinforcement Learning: Deep Q-Network, Deep Deterministic Policy Gradient.">Вопрос 2: Deep Reinforcement Learning: Deep Q-Network, Deep Deterministic Policy Gradient.</a><ul class="nav">
<li><a href="#Deep-Q-Network" title="Deep Q-Network">Deep Q-Network</a></li>
<li><a href="#Deep-Deterministic-Policy-Gradient" title="Deep Deterministic Policy Gradient">Deep Deterministic Policy Gradient</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
